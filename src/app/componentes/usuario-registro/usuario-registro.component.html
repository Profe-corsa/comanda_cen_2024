<ion-content>
  <div class="container">
    <ion-card class="login-card">
      <ion-grid>
        <ion-row>
          <ion-col size="9">
            <div class="heading">
              <h1>Registrar un {{ esCliente ? "Cliente" : "Empleado" }}</h1>
            </div>
          </ion-col>
          <ion-col size="3">
            <div class="action-buttons">
              <ion-button expand="block" type="button" (click)="scanQr()">
                <ion-icon name="qr-code-outline"></ion-icon>
              </ion-button>
            </div>
          </ion-col>
        </ion-row>
      </ion-grid>

      <form
        [formGroup]="registerForm"
        (ngSubmit)="onRegister(registerForm.value)"
      >
        <ion-grid>
          <ion-row>
            <ion-col size="">
              <!-- Nombre -->
              <div class="form-group">
                <div class="input-wrapper">
                  <!-- <ion-icon name="mail-outline"></ion-icon> -->
                  <ion-input
                    type="text"
                    placeholder="Nombre"
                    formControlName="nombre"
                  ></ion-input>
                </div>
                <div
                  *ngIf="
                    registerForm.get('nombre')?.invalid &&
                    (registerForm.get('nombre')?.dirty ||
                      registerForm.get('nombre')?.touched)
                  "
                  class="error-message"
                >
                  <ion-text
                    color="danger"
                    *ngIf="registerForm.get('nombre')?.errors?.['required']"
                  >
                    El nombre es requerido.
                  </ion-text>
                  <ion-text
                    color="danger"
                    *ngIf="registerForm.get('nombre')?.errors?.['pattern']"
                  >
                    El nombre solo puede contener letras y un espacio.
                  </ion-text>
                  <ion-text
                    color="danger"
                    *ngIf="registerForm.get('nombre')?.errors?.['minlength']"
                  >
                    El nombre no puede tener menos de 3 caracteres.
                  </ion-text>
                </div>
              </div>
            </ion-col>
            <ion-col size="6">
              <!-- apellido -->
              <div class="form-group">
                <div class="input-wrapper">
                  <!-- <ion-icon name="mail-outline"></ion-icon> -->
                  <ion-input
                    type="text"
                    placeholder="Apellido"
                    formControlName="apellido"
                  ></ion-input>
                </div>
                <div
                  *ngIf="
                    registerForm.get('apellido')?.invalid &&
                    (registerForm.get('apellido')?.dirty ||
                      registerForm.get('apellido')?.touched)
                  "
                  class="error-message"
                >
                  <ion-text
                    color="danger"
                    *ngIf="registerForm.get('apellido')?.errors?.['required']"
                  >
                    El apellido es requerido.
                  </ion-text>
                  <ion-text
                    color="danger"
                    *ngIf="registerForm.get('apellido')?.errors?.['pattern']"
                  >
                    El apellido solo puede contener letras y un espacio.
                  </ion-text>
                  <ion-text
                    color="danger"
                    *ngIf="registerForm.get('apellido')?.errors?.['minlength']"
                  >
                    El apellido no puede tener menos de 3 caracteres.
                  </ion-text>
                </div>
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>

        <!-- DNI -->
        <div class="form-group">
          <div class="input-wrapper">
            <!-- <ion-icon name="mail-outline"></ion-icon> -->
            <ion-input
              type="text"
              placeholder="DNI"
              formControlName="dni"
            ></ion-input>
          </div>
          <div
            *ngIf="
              registerForm.get('dni')?.invalid &&
              (registerForm.get('dni')?.dirty ||
                registerForm.get('dni')?.touched)
            "
            class="error-message"
          >
            <ion-text
              color="danger"
              *ngIf="registerForm.get('dni')?.errors?.['required']"
            >
              El DNI es requerido.
            </ion-text>
            <ion-text
              color="danger"
              *ngIf="registerForm.get('dni')?.errors?.['pattern']"
            >
              El DNI solo puede contener entre 7 y 8 números.
            </ion-text>
          </div>
        </div>

        <div class="form-group">
          <div class="input-wrapper">
            <!-- <ion-icon name="mail-outline"></ion-icon> -->
            <ion-input
              type="email"
              placeholder="Correo"
              formControlName="email"
            ></ion-input>
          </div>
          <div
            *ngIf="
              registerForm.get('email')?.invalid &&
              (registerForm.get('email')?.dirty ||
                registerForm.get('email')?.touched)
            "
            class="error-message"
          >
            <ion-text
              color="danger"
              *ngIf="registerForm.get('email')?.errors?.['required']"
            >
              Correo es requerido.
            </ion-text>
            <ion-text
              color="danger"
              *ngIf="registerForm.get('email')?.errors?.['email']"
            >
              Correo no es válido.
            </ion-text>
          </div>
        </div>

        <ion-grid>
          <ion-row>
            <ion-col size="">
              <div class="form-group">
                <div class="input-wrapper">
                  <!-- <ion-icon name="lock-closed-outline"></ion-icon> -->
                  <ion-input
                    [attr.type]="showPassword ? 'text' : 'password'"
                    placeholder="Clave"
                    formControlName="password"
                  ></ion-input>
                  <ion-icon
                    [name]="showPassword ? 'eye-outline' : 'eye-off-outline'"
                    (click)="togglePasswordVisibility()"
                  ></ion-icon>
                </div>
                <div
                  *ngIf="
                    registerForm.get('password')?.invalid &&
                    (registerForm.get('password')?.dirty ||
                      registerForm.get('password')?.touched)
                  "
                  class="error-message"
                >
                  <ion-text
                    color="danger"
                    *ngIf="registerForm.get('password')?.errors?.['required']"
                  >
                    Clave es requerido.
                  </ion-text>
                  <ion-text
                    color="danger"
                    *ngIf="registerForm.get('password')?.errors?.['minlength']"
                  >
                    Clave debe tener al menos 6 caracteres.
                  </ion-text>
                </div>
              </div>
            </ion-col>
            <ion-col size="">
              <div class="form-group">
                <div class="input-wrapper">
                  <!-- <ion-icon name="lock-closed-outline"></ion-icon> -->
                  <ion-input
                    [attr.type]="showRPassword ? 'text' : 'password'"
                    placeholder="Repetir Clave"
                    formControlName="rpassword"
                  ></ion-input>
                  <ion-icon
                    [name]="showRPassword ? 'eye-outline' : 'eye-off-outline'"
                    (click)="toggleRpasswordVisibility()"
                  ></ion-icon>
                </div>
                <div
                  *ngIf="
                    registerForm.get('rpassword')?.invalid &&
                    (registerForm.get('rpassword')?.dirty ||
                      registerForm.get('rpassword')?.touched)
                  "
                  class="error-message"
                >
                  <ion-text
                    color="danger"
                    *ngIf="registerForm.get('rpassword')?.errors?.['required']"
                  >
                    Clave es requerido.
                  </ion-text>
                  <ion-text
                    color="danger"
                    *ngIf="registerForm.get('rpassword')?.errors?.['minlength']"
                  >
                    Clave debe tener al menos 6 caracteres.
                  </ion-text>
                  <ion-text
                    *ngIf="registerForm.hasError('passwordMismatch')"
                    color="danger"
                    >Las claves no coinciden.</ion-text
                  >
                </div>
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>

        <div class="action-buttons">
          <ion-button expand="block" type="button" (click)="tomarFoto()">
            Tomar foto
          </ion-button>
          <ion-button
            expand="block"
            type="submit"
            [disabled]="!registerForm.valid"
          >
            Crear
          </ion-button>
          <ion-button expand="block" type="button" (click)="irAlLogin()">
            Volver
          </ion-button>
          <!-- <p>
            ¿Posees una cuenta?
            <a (click)="irAlLogin()" class="encabezado">Ir al ingreso</a>
          </p> -->
        </div>
      </form>
    </ion-card>
  </div>
</ion-content>
